产品需求文档 (PRD)

产品名称： IP伴游电子宠物 App (MVP版)
文档版本： V1.0
撰写日期： 2026-02-26
目标受众： UI/UX设计师、开发工程师

0. 背景与目标

产品背景：线下 IP 玩偶、盲盒、公仔等周边在年轻人群体中已经形成较强的情感连接，但“陪伴感”多停留在静态摆件层面，无法沉淀真实生活与旅行的故事。本 App 旨在为用户的实体 IP 玩偶提供一个“数字分身”，把用户的旅行行为转化为可视化的养成体验。

核心问题与痛点：
- 难以系统化记录“我和娃娃去了哪些地方”（传统相册以人物/风景为主，IP 仅作为道具出现）。
- 旅行纪念品难以统一管理和展示（门票、贴纸、周边散落在不同载体）。
- 将 IP 玩偶与 AI 能力结合的玩法尚未被充分验证（需要一个成本可控的 MVP）。

MVP 范围（本版本只做）：
- 仅通过**手动输入地名**模拟旅行打卡，不接入真实 GPS 与硬件蓝牙。
- 提供 1 个基础 IP 电子宠物形象 + 若干“性格”标签，用于影响日记文案的语气。
- 跑通「打卡 -> AI 生成旅行日记 -> 上传当地纪念配件 -> 在橱柜中展示」的完整闭环。

本版本明确不做（与 MoSCoW 表中的 Won't have 对齐）：
- 不接入真实蓝牙玩偶或 IoT 设备。
- 不接入真实 GPS 或轨迹采集。
- 不在客户端内实现 AIGC 图像生成功能，仅支持本地图片上传。

成功指标（示例，后续可细化为埋点指标）：
- 至少 70% 的新用户在首次会话中完成 1 次打卡并成功生成旅行日记。
- 完成 1 次以上打卡的用户中，有至少 50% 上传过 >=1 个橱柜配件。
- 生成的日记平均长度在 80~200 字之间，用户主观反馈“有陪伴感”好评率 ≥ 60%（通过简单问卷或访谈采样）。

1. 产品概述

本产品是一款结合实体IP玩偶的旅行陪伴类App。通过在App内映射用户购买的实体玩偶（电子宠物），记录用户的真实旅行轨迹，并自动生成个性化旅行日记与专属地区旅行配件。
MVP阶段目标： 暂不接入实体硬件蓝牙及真实GPS定位，通过前端软件界面模拟“位置输入”、“状态切换”与“配件上传”闭环，验证核心业务链路和UI/UX的养成游戏化体验。

2. 用户画像与使用场景

2.1 目标用户画像（Persona）

- Persona A：都市打工人（22-35 岁），平时喜欢带公仔/毛绒玩偶出门拍照，在社交媒体上分享“娃娃视角”的旅行日常，使用 iOS/Android 主流机型。
- Persona B：亲子家庭（25-40 岁），希望用 IP 玩偶记录与孩子的亲子旅行，让“娃娃”成为陪伴孩子成长的见证者，更重视操作简单与安全性。
- Persona C：IP/二次元爱好者（18-30 岁），收藏大量周边，对 IP 设定、世界观有较强代入感，希望有更“拟人化”的数字化体验。

2.2 核心使用场景（用户故事示例）

- 作为一名喜欢拍照的上班族，我希望在带着 IP 玩偶出差或旅行时，可以快速记录“去了哪里”，并自动生成一篇带有 IP 语气的日记，这样我不用自己绞尽脑汁写文案。
- 作为一名亲子家长，我希望在每次带孩子出游时，都能为孩子的 IP 玩偶“解锁一件当地专属配件”，在一个橱柜里统一查看，这样以后回顾时更有仪式感。
- 作为一名 IP 爱好者，我希望可以回看所有历史打卡日记，看到“电子宠物视角”的成长轨迹，从而更乐意持续使用这个 App。

2.3 页面结构与原型映射

- 原型形态：使用单文件 `prototype.html`，通过 HTML + CSS + 少量原生 JS，在浏览器中模拟手机 App 外观与交互。
- 视图与模块映射：
  - 首页 Tab（地图） → 对应 PRD 中「3.1 首页：中国旅行地图模块」及 F-1.01 / F-1.02 / F-1.03。
  - 宠物 Tab（宠物小屋） → 对应 PRD 中宠物性格展示与状态反馈相关需求（F-1.01 扩展）。
  - 日记 Tab（旅行日记） → 对应 PRD 中「3.3 二级页面：旅行日记模块」及 F-3.01 / F-3.02。
- 原型仅关注视觉布局与基础交互（Tab 切换、输入框、按钮点击等），数据可使用前端内置假数据或静态示例，后续接入真实 API 时按第 6 章的接口规范扩展。

3. 核心业务流程

身份初始化： 用户进入App，展示默认IP电子宠物形象。

模拟旅行打卡： 用户在“首页地图”手动输入当前旅行地并点击打卡。

数据联动生成：

地图模块： 在中国地图背景上新增一个旅行足迹标记。

日记模块： 系统结合输入的地名和当前宠物性格，通过调用 AI 文本生成能力，自动生成一篇个性化的电子宠物旅行日记。

收集与展示： 用户在“旅行橱柜”中上传本地图片（模拟获得地区专属配件），图片自动裁剪/展示在橱柜阵列中。

3. 详细功能需求说明

3.1 首页：中国旅行地图模块

需求目的： 展示电子宠物状态，并可视化用户的旅行足迹。

F-1.01 宠物形象展示：

页面视觉中心需展示电子宠物动态形象（MVP阶段可使用静态插画替代）。

界面风格需具备“养成游戏”的治愈、沉浸感（例如：柔和色彩、粗圆角、像素/卡通字体辅助）。

- 前置条件：用户已完成基本引导并进入首页地图；本地无网络时可展示默认静态形象，但不影响基础展示。
- 主流程：进入首页 -> 加载宠物形象及当前性格标签 -> 用户可点击宠物查看简单反馈（如眨眼/弹出对话气泡，若在 MVP 中实现）。
- 异常与边界：若形象资源加载失败，则展示占位图 + 文案“哎呀，宠物打了个盹，稍后再试”；不影响核心打卡功能。
- 验收标准（补充）：在主流机型上首页加载时间 ≤ 2s，宠物形象完整展示且不拉伸变形。
 - 动效要求：支持基础 idle 动画（如呼吸/眨眼），以及打卡成功、性格切换等事件触发的短反馈动画（时长不超过 1 秒，帧数控制在 24 帧以内），保证不卡顿。

F-1.02 宠物性格切换：

提供一个下拉菜单或按钮组，支持切换宠物的性格（例如：活泼、文艺、吃货）。

验收标准： 切换后，界面需明确显示当前性格标签，且该字段需作为参数传递给“旅行日记”生成逻辑。

- 前置条件：用户已进入首页，宠物形象正常展示。
- 主流程：用户点击性格切换控件 -> 展示性格选项列表 -> 用户选择新的性格 -> UI 更新当前性格标签 -> 更新内存中当前性格状态。
- 异常与边界：若切换请求失败（例如后端同步失败），前端仍以本地状态为主，并提示“性格已本地更新，稍后自动同步”；性格选项数量建议控制在 3~5 个。
- 额外验收：新生成的日记需体现不同性格在语气和用词上的差异（在 AI Prompt 中体现）。

F-1.03 模拟旅行打卡（替代真实GPS）：

提供一个文本输入框，支持用户输入地名（如：北京、武汉）。

提供一个“打卡/定位”按钮。

验收标准： 点击按钮后，校验输入框非空；校验通过后，在背景地图容器中生成一个“图钉/标记”，并触发【F-3.01 日记生成逻辑】。

- 前置条件：用户已选择宠物性格（若未选择，则使用默认性格，如“活泼”）。
- 主流程：用户输入地名 -> 点击“打卡” -> 前端做基础校验（非空、长度限制、非法字符过滤） -> 通过后在地图上新增一个足迹点 -> 调用后端创建一次 CheckIn 记录 -> 触发 AI 日记生成任务。
- 异常与边界：
  - 输入为空：给出错误提示“请输入一个城市或地点名称”，不触发后续流程。
  - 网络错误或后端失败：地图上仍可先乐观显示足迹点，但需要显式提示“日记生成失败，可稍后重试”。
  - 同一地点重复打卡：允许重复，但在 PRD 中建议最多在时间轴中展示最近 N 条，后续可按需折叠。

3.2 二级页面：旅行橱柜模块

需求目的： 沉淀用户的旅行成就，展示具有地域特色的IP配件（如：武汉热干面配件）。

F-2.01 橱柜阵列展示：

以网格（Grid）形式展示用户已收集的配件列表。

初始状态为空或展示引导占位图。

- 前置条件：用户已登录/初始化完成，已进入“橱柜”页面。
- 主流程：加载该用户的橱柜配件列表 -> 以网格形式展示 -> 无数据时展示引导占位图（例如“去旅行解锁你的第一件配件吧！”）。
- 异常与边界：当图片加载失败时，以默认占位图显示，配件名称仍可正常展示。
- 验收标准（补充）：在存在 20 个配件的情况下，橱柜页首屏进入时间 ≤ 3s，滑动流畅。

F-2.02 配件模拟上传：

提供“上传专属配件”按钮。

验收标准： 唤起系统本地相册/文件选择器；用户选择图片后，系统读取图片并在橱柜网格中新增一个物件卡片（包含图片和默认名称，如“未命名配件”）。

- 前置条件：用户已授予相册访问权限（如系统权限被拒绝，则需给出引导弹窗，跳转系统设置）。
- 主流程：点击“上传专属配件” -> 调用系统文件/相册选择器 -> 用户选择图片 -> 前端进行基础校验（文件大小、格式） -> 成功后上传至服务端或本地存储 -> 刷新橱柜网格新增一项。
- 异常与边界：
  - 文件过大或格式不支持：给出错误提示“图片过大或格式不支持，请重新选择（建议 JPG/PNG，≤ 5MB）”。
  - 上传中断或失败：保留本地重试能力或简单提示“上传失败，请检查网络后重试”，不影响现有已展示配件。

3.3 二级页面：旅行日记模块

需求目的： 强化IP陪伴感，将冰冷的地理位置转化为有温度的日记。

F-3.01 日记信息流：

以时间轴或卡片列表形式展示旅行日记，按时间倒序排列（最新打卡的在最上方）。

F-3.02 自动生成日记：

当用户在首页执行【F-1.03 模拟旅行打卡】成功后，本模块需自动新增一条日记。

生成规则： 提取当前日期、打卡地点、当前宠物性格。拼接成文案展示。例如：（活泼性格+武汉） -> “2026-X-X：今天主人带我来到了武汉！这里好热闹，我还想去更多的地方探险！”

- 前置条件：打卡行为已在后端落库并成功返回 CheckIn 记录；或前端已拿到可以唯一标识本次打卡的 ID。
- 主流程：前端向后端触发“生成日记”请求 -> 后端通过 OpenRouter 调用 `gemini-3.0-flash` 模型生成日记文案 -> 将结果写入 DiaryEntry 并返回给前端 -> 前端在日记列表中插入一条新卡片。
- 异常与边界：
  - AI 生成超时或失败：使用本地模板生成一条兜底文案（参见第 6 章“失败与降级策略”），并在 UI 中以“来自模板”的标记区分。
  - 多次快速打卡：按时间顺序排队生成，以“最近打卡优先”策略处理，避免用户感知到明显延迟。
 - 可选插图：当地点存在预置场景插画（如“埃及金字塔”）时，日记条目可附带 `sceneImageUrl` 缩略图字段，在宠物页的日记卡片中展示对应插图。

9. 视觉资产与动效规范

9.1 美术风格总览

- 整体色彩：低饱和、暖色调的治愈系卡通风格，避免冷硬科技感。
- 地图与房间：采用手绘或像素拟物风，不使用写实地球/卫星地图；轮廓与细节适配移动端小屏展示。
- 组件形态：大圆角（≥16px）、柔和阴影、新拟物轻量质感，与原型中的 `glass-card` 卡片风格保持一致。

9.2 关键视觉资产清单（原型阶段）

- 中国地图底图：
  - 用途：地图 Tab 的主背景，用于承载打卡图钉。
  - 资源：卡通中国地图插画（如 Freepik/Vecteezy 等，当前仅用于原型，后续需替换为正式授权版本）。
  - 文件约定：建议存放于 `assets/map/china-kawaii-map.png`。
- 宠物之家底图：
  - 用途：宠物页上半部分的房间背景，承载宠物 avatar 与互动气泡。
  - 资源：`img_v3_02v9_7be11faf-d1f7-4184-8d3e-6693cd92028g.jpg` 作为默认房间插画；其他插画（如 `img_v3_02v9_e5e8fa0c-...png`、`img_v3_02v9_283cff82-...png`、`1814750...jpg`）规划为后续房间主题皮肤。
  - 文件约定：建议存放于 `assets/room/` 目录，后续按主题命名。
- 宠物动画帧：
  - 用途：在宠物页中以序列帧方式呈现宠物 idle/反馈动画，并在日记中作为头像符号。
  - 资源：`比卡丘动画导出/观察/flog_guancha_002.png`、`flog_guancha_003.png` 等，对应“观察/张望”等动作。
  - 文件约定：建议重命名并放置于 `assets/pet/observe/`，统一尺寸（例如 256×256，背景透明）。
- 目的地场景插画：
  - 用途：在特殊地点（如“埃及”）打卡时，用作地图场景预览、橱柜纪念品缩略图以及日记插图。
  - 资源：`场景/埃及金字塔.png` 等；与业务字段 `location` 通过字典方式关联。
  - 文件约定：建议存放于 `assets/scenes/` 目录，并在文档中维护 location 到资源文件路径的映射表。

9.3 视觉尺寸与分辨率

- 地图与房间底图：建议原始分辨率不少于 1920×1080（16:9），在前端按等比缩放适配 390–414px 宽度手机屏幕。
- 宠物序列帧：统一为正方形（如 256×256），保证在缩放到约 96px 高度时细节仍清晰。
- 场景缩略图：在橱柜与日记中展示时建议使用 64–80px 边长的缩略图，避免影响文本阅读。

9.4 动效触发规则

- 打卡成功：
  - 地图页：新图钉采用“自上而下掉落 + 轻微弹跳”的动画；持续时间约 0.5 秒。
  - 宠物页：宠物播放一次“兴奋/反馈”动画（例如头部抖动或耳朵抖动），同时在宠物 Tab 显示红点提示有新动态。
  - 橱柜与日记：若地点存在场景插画，则同时在橱柜中新增一件带插图的纪念品卡片，并在最新一条日记中展示对应缩略图。
- 性格切换：
  - 宠物在房间中播放一段简短“自我介绍”式动画（可复用观察序列帧），同时更新后续日记文案的语气模板。
- 进入宠物页：
  - 若存在未阅读的新日记或新纪念品，宠物 Tab 的红点提示展示 1 次即可，不做持续闪烁，避免干扰。


4. 交互与UI/UX规范

导航结构： 采用底部全局导航栏（Tab Bar），包含“地图（首页）”、“橱柜”、“日记”三个入口，支持无缝点击切换。

设计语言： 避免冷硬的科技风。要求使用低饱和度治愈色系（如：奶油黄、薄荷绿、婴儿蓝），大量使用圆角（圆角半径>=16px），按钮需带有轻微的物理按压阴影（拟物或新拟态轻量版）。

5. 功能优先级表格 (MoSCoW 模型)

需求编号

功能模块

功能名称

优先级 (MoSCoW)

说明

F-1.01

首页地图

宠物形象与地图场景展示

Must have (必须有)

MVP的核心视觉承载

F-1.03

首页地图

模拟旅行打卡与足迹标记

Must have (必须有)

替代硬件GPS的核心输入源

F-2.01

旅行橱柜

橱柜网格展示

Must have (必须有)

核心收集玩法的展示载体

F-2.02

旅行橱柜

本地图片上传生成配件

Must have (必须有)

跑通“获得纪念品”的软件链路

F-3.01

旅行日记

日记列表展示

Must have (必须有)

核心陪伴玩法的展示载体

F-3.02

旅行日记

结合地点/性格自动生成文案

Must have (必须有)

验证IP情感化设计的核心点

F-1.02

首页地图

宠物性格状态切换

Should have (应该有)

丰富日记生成维度的重要变量

N/A

全局

UI动效与按压反馈

Could have (可以有)

提升质感，若时间不足可简化

N/A

底层

硬件蓝牙连接与真实GPS获取

Won't have (本次没有)

MVP阶段暂不实现，留待V2.0

N/A

橱柜

接入AI图像生成(AIGC)制作配件

Won't have (本次没有)

规划中，MVP阶段仅用本地上传替代

6. AI 生成逻辑与接口规范（OpenRouter + gemini-3.0-flash）

6.1 能力范围与原则

- 本版本 AI 仅用于**生成旅行日记文案**，不做路径规划、地点推荐或其他决策性输出。
- 日记必须基于用户输入的地名和宠物性格，不得虚构用户未输入的地点或真实个人隐私信息，避免“幻觉”。
- 文案语气以“电子宠物第一人称”视角为主，整体风格治愈、轻松，不输出攻击、色情、暴力等不当内容。

6.2 GenerateDiary 接口（产品级字段定义）

输入字段（由客户端/后端整理后传给模型）：
- `date`：当前日期，字符串，如 `2026-02-26`。
- `location`：用户手动输入的地名，如“武汉”“北京环球影城”。
- `petPersonality`：当前宠物性格标签，如“活泼”“文艺”“吃货”。
- `userNote`（可选）：用户在打卡时补充的备注文案（若后续版本支持）。
- `language`：当前 App 语言，MVP 默认为“zh-CN”。

输出字段（后端解析模型返回后提供给前端）：
- `title`：日记标题，长度建议 ≤ 20 字。
- `content`：日记正文，长度建议 80~200 字。
- `moodTag`：情绪标签，如“兴奋”“放松”“治愈”，用于后续可视化。
- `rawModelResponse`：模型原始返回（仅用于调试/埋点，前端不直接展示）。

调用策略（建议值，可在技术方案中细化）：
- 模型：通过 OpenRouter 调用 `google/gemini-3.0-flash`。
- 温度（temperature）：0.6~0.8 之间，默认 0.7。
- 最大 tokens：不超过 512（保证响应速度）。
- 并发与频控：同一用户短时间内连续打卡时，可在后端做简单频率限制（例如每分钟最多触发 3 次生成请求）。

6.3 Prompt 示例（草案）

示例 Prompt（简化版）：

> 你是一只电子宠物玩偶，请用第一人称，为我的主人写一段旅行日记。要求：\n
> - 使用中文，语气可爱、治愈。\n
> - 当前日期：{{date}}。\n
> - 我和主人正在：{{location}}。\n
> - 我的性格是：{{petPersonality}}（请在文案中自然体现这种性格特点）。\n
> - 字数控制在 80~200 字之间。\n
> - 不要虚构主人没有说过的隐私信息，不要输出暴力、色情、歧视内容。

6.4 失败与降级策略

- 请求超时 / 网络错误：后端返回错误码，前端展示 Toast“生成失败，请检查网络后重试”，并提供“重新生成”按钮。
- 模型返回内容为空或不符合规则：触发模板兜底文案，例如：“{{date}}：今天主人带我来到了{{location}}，虽然网络有点小问题，但我还是很开心能和主人一起冒险！”。
- 日志与埋点：所有生成失败、重试行为需埋点，便于后续优化 Prompt 或参数。

6.5 原型阶段实现方式（HTML 原型约束）

- 在 HTML 原型阶段，如暂未接入 OpenRouter 实际接口，允许通过固定模板文案 + Loading 占位符模拟 AI 生成过程。
- 原型中「生成日记」按钮的行为可以简化为：点击后短暂显示“生成中”，随后插入一条示例日记卡片，其内容风格需遵循本章节的语气与长度要求。
- 当后续接入真实 OpenRouter + gemini-3.0-flash 时，仅需将「示例文案生成逻辑」替换为实际接口调用逻辑，交互流程保持一致。

7. 数据结构与状态说明（产品视角）

7.1 核心实体（仅列出关键字段）

- `User`：用户
  - userId、昵称、头像、注册时间等。
- `PetProfile`：电子宠物档案
  - petId、所属 userId、当前性格（petPersonality）、创建时间。
- `CheckIn`：打卡记录
  - checkInId、userId、petId、locationName、createdAt、userNote（可选）、生成状态（待生成/生成中/已生成/失败）。
- `DiaryEntry`：日记条目
  - diaryId、userId、petId、checkInId、title、content、moodTag、createdAt、来源类型（AI/模板）。
- `CabinetItem`：橱柜配件
  - itemId、userId、imageUrl（或本地标识）、displayName、relatedLocation（可选）、createdAt。

7.2 状态流转（简要）

- 打卡状态流：未打卡 -> 用户输入地名并点击打卡 -> 创建 CheckIn（状态：待生成）-> 触发 AI -> 成功则创建 DiaryEntry 并将 CheckIn 状态更新为“已生成”；失败则标记为“失败”，可提供重试能力。
- 日记展示流：当用户进入“日记”页面时，按 DiaryEntry 的 createdAt 倒序加载，最新记录在顶部。
- 宠物性格影响范围：仅影响**打卡之后新生成的日记**，不回溯修改历史日记。

8. 非功能需求与埋点（NFR）

8.1 性能与体验

- 首页加载时间：在主流 4G/5G 网络下，首次进入首页白屏时间 ≤ 2.5s。
- 日记生成：95% 的请求在 3s 内返回，最长不超过 8s；超时则触发降级策略。
- 图片上传：单张图片大小建议 ≤ 5MB，超过则前端提示压缩或更换图片。

8.2 隐私与数据安全

- 不采集真实 GPS 定位，仅使用用户主动输入的地名字符串。
- 用户上传的图片仅用于本 App 内部展示，不默认对外公开分享；后续若增加分享功能需单独评审。
- 对日记文本和图片的存储需满足基础访问控制，防止其他用户未经授权访问。

8.3 埋点与可观测性（示例事件）

- `check_in_click`：点击打卡按钮（包含 location 文本长度、是否为空）。
- `ai_generate_start` / `ai_generate_success` / `ai_generate_fail`：AI 生成开始/成功/失败。
- `diary_card_view`：用户浏览日记卡片（可按曝光或点击统计）。
- `cabinet_upload_start` / `cabinet_upload_success` / `cabinet_upload_fail`：配件上传过程。

8.4 前端原型实现范围（HTML + CSS）

- 原型技术栈：纯前端静态页面，使用 HTML + CSS（可引入 Tailwind 等样式库）+ 少量原生 JavaScript，不依赖构建工具。
- 设备适配：以 390–414px 宽度的手机竖屏为主视口，PC 上通过居中 + 圆角边框模拟“手机壳”；不要求横屏和 Pad 适配。
- 交互深度：仅实现 Tab 切换、表单输入、按钮状态反馈、简单动画等基础交互；数据持久化可使用内存状态或本地假数据，暂不要求登录/多设备同步。
- 网络能力：在原型阶段可不接入真实后端与 OpenRouter 接口，允许全部在前端用 Mock 数据模拟，后续接入真实服务时按本 PRD 的接口与状态流转设计扩展。